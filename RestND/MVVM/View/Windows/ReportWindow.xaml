<Window x:Class="RestND.MVVM.View.Windows.ReportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        xmlns:viewModel="clr-namespace:RestND.MVVM.ViewModel.Windows"
        xmlns:uc="clr-namespace:RestND.MVVM.View.UserControls"
        xmlns:fa="clr-namespace:FontAwesome.WPF;assembly=FontAwesome.WPF"
        mc:Ignorable="d"
        Style="{StaticResource windowStyle}">

    <Border Style="{DynamicResource windowBorder}">
        <Grid Margin="16">
            
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- sideBar -->
            <Expander Style="{DynamicResource sideBarExpander}"
                      Grid.Row="0"
                      Grid.RowSpan="3"
                      Grid.Column="1"
                      Margin="12,0,0,0">
                <uc:SideBar/>
            </Expander>

            <!-- top section -->
            <Border Grid.Row="0"
                    Grid.Column="0"
                    Margin="0,0,12,12"
                    Padding="14"
                    CornerRadius="12"
                    Background="{DynamicResource CardBG}"
                    BorderBrush="{DynamicResource LightBG}"
                    BorderThickness="1">

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Filters -->
                    <WrapPanel Grid.Column="0"
                               VerticalAlignment="Center"
                               ItemHeight="30">

                        <TextBlock Text="From"
                                   Margin="0,0,6,0"
                                   VerticalAlignment="Center"
                                   Foreground="{DynamicResource LightText}"/>

                        <DatePicker SelectedDate="{Binding FromDate}"
                                    Width="140"
                                    Margin="0,0,14,0"/>

                        <TextBlock Text="To"
                                   Margin="0,0,6,0"
                                   VerticalAlignment="Center"
                                   Foreground="{DynamicResource LightText}"/>

                        <DatePicker SelectedDate="{Binding ToDate}"
                                    Width="140"
                                    Margin="0,0,14,0"/>

                        <TextBlock Text="Filter"
                                   Margin="0,0,6,0"
                                   VerticalAlignment="Center"
                                   Foreground="{DynamicResource LightText}"/>

                        <ComboBox Width="170"
                                  ItemsSource="{Binding FilterOptions}"
                                  SelectedItem="{Binding SelectedFilter}"
                                  Margin="0,0,14,0"/>
                    </WrapPanel>

                    <!-- Action Buttons -->
                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Right">

                        <Button Command="{Binding LoadChartDataCommand}"
                                Style="{DynamicResource loginBtn}"
                                Margin="0,0,10,0"
                                Padding="14,6"
                                Content="Load Report"/>

                        <Button Command="{Binding ExportCsvCommand}"
                                Style="{DynamicResource loginBtn}"
                                Margin="0,0,10,0"
                                Padding="14,6"
                                Content="Download CSV"/>

                        <Button Click="DownloadPng_Click"
                                Style="{DynamicResource loginBtn}"
                                Padding="14,6"
                                Content="Download PNG"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- graph section -->
            <Border Grid.Row="1"
                    Grid.Column="0"
                    Margin="0,0,12,12"
                    Padding="14"
                    CornerRadius="12"
                    Background="{DynamicResource CardBG}"
                    BorderBrush="{DynamicResource LightBG}"
                    BorderThickness="1">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <DockPanel Grid.Row="0" LastChildFill="False" Margin="0,0,0,10">
                        <TextBlock Text="Sales Report"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource LightText}"
                                   DockPanel.Dock="Left"/>

                        <!-- optional small hint -->
                        <TextBlock Text="{Binding SelectedFilter}"
                                   Foreground="{DynamicResource secondaryHeaders}"
                                   VerticalAlignment="Bottom"
                                   Margin="10,0,0,0"
                                   DockPanel.Dock="Left"/>
                    </DockPanel>

                    <!-- Chart -->
                    <lvc:CartesianChart x:Name="ReportChart"
                                        Grid.Row="1"
                                        Series="{Binding SeriesCollection}"
                                        LegendLocation="Right"
                                        Foreground="{DynamicResource LightText}">

                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Dishes"
                                      Labels="{Binding Labels}"
                                      Foreground="{DynamicResource LightText}">
                                <lvc:Axis.Separator>
                                    <lvc:Separator/>
                                </lvc:Axis.Separator>
                            </lvc:Axis>
                        </lvc:CartesianChart.AxisX>

                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Quantity Sold"
                                      MinValue="0"
                                      Foreground="{DynamicResource LightText}"
                                      LabelFormatter="{Binding YFormatter}">
                                <lvc:Axis.Separator>
                                    <lvc:Separator Step="1"/>
                                </lvc:Axis.Separator>
                            </lvc:Axis>
                        </lvc:CartesianChart.AxisY>

                    </lvc:CartesianChart>
                </Grid>
            </Border>

            <!-- footer -->
            <Grid Grid.Row="2"
                  Grid.Column="0"
                  Margin="0,0,12,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <uc:ReturnBtn x:Name="returnBtn"
                              Grid.Column="0"
                              VerticalAlignment="Bottom"
                              Margin="0,0,12,0"/>

                <TextBlock Grid.Column="1"
                           Style="{DynamicResource copyWrite}"
                           VerticalAlignment="Bottom"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,0"/>
            </Grid>

        </Grid>
    </Border>
</Window>
